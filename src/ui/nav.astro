---
import Theme from "../components/theme.astro"
import { lucia } from "../lib/auth"

const cookiename = lucia.sessionCookieName
---
<header class="sticky top-0 z-30 mx-auto w-full border border-gray-100/20 bg-white/20 py-3 shadow backdrop-blur-lg">
    <div class="px-4">
        <div class="flex items-center justify-between">
            <div class="flex shrink-0">
                <a aria-current="page" class="flex items-center gap-2" href="/">
                    <img class="h-7 w-auto" src="pen.png">
                    <p class="font-bold">BLOG</p>
                </a>
            </div>
            <div class="hidden md:flex md:items-center md:justify-center bg-white px-2 py-1 rounded gap-2">
                <img src="search.svg" class="w-5">               
                <input type="text" placeholder="search" class="bg-white/80 focus:outline-none text-black">
            </div>
            <div class="flex items-center justify-end gap-3">
                <Theme />
                <button class="auth antibutton hidden p-2 rounded text-sm font-semibold sm:block" onclick="window.location.href = '/login'">Login</button>
                <button class="auth hidden p-2 rounded text-sm font-semibold text-nowrap sm:block" onclick="window.location.href='/signup'">Sign up</button>
                <!-- <div class="block sm:hidden">mobile</div> -->
            </div>
        </div>
    </div>
</header>

<script define:vars={{ cookiename }}>
    var cookies = document.cookie.split(';').reduce((acc, cookie) => {
        const [name, value] = cookie.split('=').map(c => c.trim())
        acc[name] = value
        return acc
    }, {})

    var checkifloggedin = cookies[cookiename] ?? null
    if (checkifloggedin) {
        document.querySelectorAll('.auth').forEach(auth => {
            auth.style.display = 'none'
        })
    }
</script>